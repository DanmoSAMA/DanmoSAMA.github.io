<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>git 笔记 | DanmoSAMAの博客</title><meta name="keywords" content="git"><meta name="author" content="Danmoits"><meta name="copyright" content="Danmoits"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="git 笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="git 笔记">
<meta property="og:url" content="https://danmosama.github.io/2022/10/13/git%20%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="DanmoSAMAの博客">
<meta property="og:description" content="git 笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://z3.ax1x.com/2021/08/17/fIut8s.png">
<meta property="article:published_time" content="2022-10-13T00:58:48.900Z">
<meta property="article:modified_time" content="2022-10-13T00:59:56.734Z">
<meta property="article:author" content="Danmoits">
<meta property="article:tag" content="git">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://z3.ax1x.com/2021/08/17/fIut8s.png"><link rel="shortcut icon" href="/img/avatar.jpg"><link rel="canonical" href="https://danmosama.github.io/2022/10/13/git%20%E7%AC%94%E8%AE%B0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'git 笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-10-13 08:59:56'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "https://z3.ax1x.com/2021/08/18/fIcAZ6.gif" data-lazy-src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/message/"><i class="fa-fw fa fa-comment"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://z3.ax1x.com/2021/08/17/fIut8s.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">DanmoSAMAの博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/message/"><i class="fa-fw fa fa-comment"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">git 笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-10-13T00:58:48.900Z" title="发表于 2022-10-13 08:58:48">2022-10-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-10-13T00:59:56.734Z" title="更新于 2022-10-13 08:59:56">2022-10-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/git/">git</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h1><h2 id="status"><a href="#status" class="headerlink" title="status"></a>status</h2><p><code>git status -s</code> 或者 –short 可以查看简略状态信息：</p>
<p>左侧的状态一共有两列。</p>
<ul>
<li><p>?? 表示还没有被追踪的文件。</p>
</li>
<li><p>左侧的M，或者说绿色的M，表示该文件有修改被添加到暂存区 。</p>
</li>
<li><p>右侧的M，或者说红色的M，表示该文件在工作区有修改，未添加到暂存区。</p>
<p>综上，MM 表示文件先修改了一部分，add，再修改了一部分。</p>
</li>
<li><p>D 表示文件被删除。</p>
</li>
</ul>
<h2 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h2><p><code>git diff</code> 直接使用，可以查看工作区具体有哪些修改。</p>
<p><code>git diff --staged</code> 可以对比暂存区和最近的一次修改，–cached 选项用法与此相同。</p>
<p>我们想知道 B 相对 A 多了哪些提交，如果 A 是 B 的祖先，直接 diff 即可。如果 A 和 B 分叉过，diff 会同时显示 A 中新增的内容“已删除”。为了避免这个现象，需要先找到 A 和 B 的公共祖先，再进行 diff。</p>
<p><code>git merge-base B A </code> 会输出两个分支最近公共祖先的 Hash，目测交换顺序也可以，然后 diff，或者合并为一步。</p>
<p><code>git diff $(git merge-base B A)</code></p>
<p><code>git diff A...B</code> 上边的语法糖，也会找最近公共祖先，不能交换 A B 的顺序。</p>
<h2 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h2><p><code>git commit -v</code> 会在编辑 message 界面时，列举出当前的 diff 信息，表明当前要提交哪些修改。</p>
<h2 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h2><p><code>git rm</code> 会直接从硬盘删除文件，如果文件在工作区或暂存区有修改，需要加 -f 强制删除。</p>
<p>如果想在硬盘中保留，但不想让 git 继续追踪，可以加 –cached，这样文件会变为 untracked file。</p>
<h2 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h2><p><code>git mv &lt;old_name&gt; &lt;new_name&gt;</code> 可以用于文件改名，修改会被直接添加到暂存区，git 会认为这是一个 renamed file。</p>
<p>如果是直接在 vscode 对文件进行改名，则 git 认为原来的文件被删除，新的文件成为 untracked file。</p>
<p>不过，mv 只是一个语法糖，修改的本质还是先删后增，如果先 mv，再 git restore –staged，能观察到和上一行一样的效果。</p>
<h2 id="log"><a href="#log" class="headerlink" title="log"></a>log</h2><p>git log 选项：</p>
<p><code>-p</code>：详细显示每次提交都有哪些修改。</p>
<p><code>-&lt;n&gt;</code>：限制 log 的条数，只显示最新 n 次修改的 log。</p>
<p><code>--stat</code>：显示每次提交都有哪些修改的缩略信息，只能看到每个文件的++–符号。</p>
<p><code>--pretty</code>：指明格式，值可以是 oneline，如 –pretty=online。这里还可以使用 format。</p>
<p><code>--oneline</code>：是上边的缩略写法，同时也包括了<code>--abbrev-commit</code> 的作用，即不显示完整哈希值。</p>
<p><code>--graph</code>：显示分支和合并图。</p>
<p><code>--since</code>：指定时间。值可以是：2.weeks，”2008-01-15”，”2 years 1 day 3 minutes ago”。</p>
<p><code>--author</code>：指定作者。</p>
<p><code>--grep</code>：在 message 中搜索关键词。</p>
<p><code>-S</code>：提供一个字符串，只列举增删了该字符串的提交。比如我在 a.txt 里新增了 Danmo 后提交，然后 git log -S “Danmo”，就能找到我的这一次提交。</p>
<p><code>--</code>：提供文件路径，查找和该文件相关的提交的 log。</p>
<p><code>--all-match</code>：如果指定了多个筛选条件，需要加这个选项，拿多个 –grep 举例，如果不加，只有第一个生效。</p>
<p><code>--decorate</code>：查看分支和 HEAD 指向哪次 commit。</p>
<p>一般 git log 只显示该分支指向的 commit 及之前的记录，<code>git log &lt;branch_name&gt;</code>  查看特定分支的记录，–all 显示所有记录。</p>
<p><code>git log --no-merges issue54..origin/master</code> 不显示合并记录，后面的参数表示 commit range，后者没有包含在前者中的记录。</p>
<p><code>git log branchA --not branchB</code> 显示 branchA 中没有包括在 branchB 中的提交，用来查看他人新的提交。</p>
<h2 id="amend"><a href="#amend" class="headerlink" title="amend"></a>amend</h2><p>如果刚刚完成了一次提交，发现有 forgotten_file 忘了提交，此时可以把它加入暂存区，然后 git commit –amend。</p>
<p>这种方式同样适用于修改 commit message。</p>
<p>–amend 会更改最后一次提交的 HASH，如果已经 push 就不要再更改。</p>
<p>如果不想修改 commit message 还可以添加 <code>--no-edit</code> 选项。</p>
<h1 id="remote"><a href="#remote" class="headerlink" title="remote"></a>remote</h1><p><code>git remote</code> 显示远程服务器 shortname，如果是 clone，默认名为 origin。</p>
<p><code>git remote -v</code> 可以显示 shortname 和 URL，可见只是用 origin 指代远程服务器 URL。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git remote -v</span><br><span class="line"></span><br><span class="line">origin  https://github.com/DanmoSAMA/remote-sensing (fetch)</span><br><span class="line">origin  https://github.com/DanmoSAMA/remote-sensing (push)</span><br><span class="line"></span><br><span class="line">git push https://github.com/DanmoSAMA/remote-sensing == git push origin</span><br></pre></td></tr></table></figure>

<p>origin/master 可以访问 shortname 为 origin 的仓库的 master 分支。</p>
<p><code>git remote add &lt;shortname&gt; &lt;url&gt;</code> add 后面可以自定义 shortname。</p>
<p><code>git remote show &lt;remote&gt;</code> 查看 remote 的详细信息。</p>
<blockquote>
<p>This command shows which branch is automatically pushed to when you run <code>git push</code> while on certain branches. It also shows you which remote branches on the server you don’t yet have, which remote branches you have that have been removed from the server, and multiple local branches that are able to merge automatically with their remote-tracking branch when you run <code>git pull</code>.</p>
</blockquote>
<p><code>git remote rename &lt;old_name&gt; &lt;new_name&gt;</code> 更改 shortname。</p>
<p><code>git remote remove &lt;shortname&gt;</code> <code>git remote add &lt;shortname&gt; &lt;url&gt;</code></p>
<h1 id="tag"><a href="#tag" class="headerlink" title="tag"></a>tag</h1><p><code>git tag -l &quot;v1.8.5*&quot;</code> 使用通配符来筛 tag 列表，-l 指定通配符。</p>
<p><code>git tag -a v1.0 -m &lt;message&gt;</code> 创建 annotated tag，并附注信息。</p>
<p>-d 选项可以删除 tag。</p>
<p><code>git show &lt;tag_name&gt; </code>  可以连同对应的提交一起，查看某个 tag 信息。</p>
<p>Lightweight tag 仅仅用于标记某次 commit，创建时无需添加任何选项，git show 也只能看到 commit 信息。</p>
<p>如果想要对之前的 commit 打 tag，只需 <code>git tab -a v1.0 &lt;commit_hash&gt;</code>。</p>
<p><code> git push &lt;remote&gt; tags</code> 可以将所有 tags 发送到 remote。</p>
<p><code>git push &lt;remote&gt; --follow-tags</code> 仅发送 annotated tag。</p>
<p><code>git push &lt;remote&gt; --delete &lt;tagname&gt;</code> 删除 remote tag。</p>
<p>由于 tag 是指向 commit 的指针，因此可以应用于 detached HEAD 模式，<code>git checkout -b version2 v2.0.0</code> 从该 commit 分出了一个分支。</p>
<h1 id="branch"><a href="#branch" class="headerlink" title="branch"></a>branch</h1><h2 id="basic"><a href="#basic" class="headerlink" title="basic"></a>basic</h2><p><code>git switch -</code> 回到上一次切换前的分支。</p>
<p><code>git branch -v</code> 查看每个分支上的最后一次提交。</p>
<p><code>git branch -vv</code> 在上方基础上，查看 tracking branch。</p>
<p><code>git branch --merge</code> 查看哪些分支已经合并到了当前分支，–no-merge 查看没合并的分支。</p>
<p>没合并的分支，用 git branch -d 无法删除，需要用 -D 强行删除。</p>
<p><code>git branch --merge &lt;branch_name&gt;</code> 同上，但无需先切换到那个分支上。</p>
<p><strong><code>git branch --move &lt;old_name&gt; &lt;new_name&gt;</code> 修改本地分支名。</strong></p>
<p><code>git merge --abort</code> 终止 merge。</p>
<h2 id="remote-1"><a href="#remote-1" class="headerlink" title="remote"></a>remote</h2><p><code>git push --set-upstream origin &lt;new_name&gt; </code> 将此修改推到远程。</p>
<p><strong><code>git push origin --delete &lt;old_name&gt;</code> 删除远程的旧分支。</strong></p>
<p><code>git ls-remote &lt;remote&gt;</code>  列举远程分支。</p>
<p><code>git push origin 本地分支名:远程分支名</code>  push 时希望修改分支名称。</p>
<p>git fetch 后，本地会新增 origin/xxx 分支，这个分支不能修改，可以把它合并到本地已有分支，也可以新建一个分支，拥有和它一样的指向：<code>git checkout -b xxx origin/xxx</code>。</p>
<p><code>git switch -c &lt;branch&gt; --track &lt;remote&gt;/&lt;branch&gt;</code> 同理，<code>git switch --guess &lt;branch&gt;</code> 为其简写。</p>
<p>上面的做法，新建的分支会成为 tracking branch，追踪远程的 origin/xxx 分支。</p>
<p><code>git checkout --track origin/xxx</code> 是简写。</p>
<p><code>git branch -u origin/xxx</code> 已有分支，更改上游。</p>
<p>如果存在上游分支，在 merge 的时候可以用 <code>@&#123;u&#125;</code> 指代上游，如：git merge @{u}</p>
<p><code>git fetch --all</code> 拉取所有分支的更新。</p>
<p><code>git remote set-head origin &lt;origin_branch_name&gt;</code> 设置远程 HEAD 指向。</p>
<h2 id="rebase"><a href="#rebase" class="headerlink" title="rebase"></a>rebase</h2><p><code>git rebase master server</code> 把 server 分支 rebase 到 master 上，这样的好处是不需要先切到 server 分支。</p>
<p><code>git rebase --onto master server client</code>  先找到 client 分支，将 client 从 server 分叉之后的部分 rebase 到 master。</p>
<h3 id="perils-of-rebase"><a href="#perils-of-rebase" class="headerlink" title="perils of rebase"></a>perils of rebase</h3><p>如果对已经提交的分支进行 rebase，并且 push -f 强行提交，会出现问题。结合 git book 里面的图更好理解。</p>
<blockquote>
<p>If you only ever rebase commits that have never left your own computer, you’ll be just fine. If you rebase commits that have been pushed, but that no one else has based commits from, you’ll also be fine. If you rebase commits that have already been pushed publicly, and people may have based work on those commits, then you may be in for some frustrating trouble, and the scorn of your teammates.</p>
</blockquote>
<p>别人可能 fetch 过这个分支，并且合并到了自己的分支上（相当于 pull），假设这个分支包含了 C1 的修改。</p>
<p>此时，把 包含 C1 的分支 rebase，并且使用 push -f 提交。</p>
<p>别人再用 pull 时，把 rebase 后的分支与本地合并，此时 git log 会看到有两个一模一样的 C1 的提交，造成困惑。</p>
<p>如果团队中有成员进行过这样的操作，应该：You rebase, and I rebase.</p>
<p>如果是分步进行，则先 fetch，再 <code>git rebase origin/xxx</code>，直接把当前分支 rebase 到远程分支的后面，git 会智能地帮我们处理好一切。</p>
<p>如果是合并进行，则 <code>git pull --rebase</code>，可以设置 –rebase 为默认：<code>git config --global pull.rebase true</code>。</p>
<h1 id="distributed-git"><a href="#distributed-git" class="headerlink" title="distributed git"></a>distributed git</h1><p><code>git diff --check</code> 在提交之前，检查是否存在 “whitespace issues”。</p>
<blockquote>
<p>The <code>--squash</code> option takes all the work on the merged branch and squashes it into one changeset producing the repository state as if a real merge happened, without actually making a merge commit. This means your future commit will have one parent only and allows you to introduce all the changes from another branch and then make more changes before recording the new commit. Also the <code>--no-commit</code> option can be useful to delay the merge commit in case of the default merge process.</p>
</blockquote>
<p>假设要把分支 B 合并到分支 A 上，–squash 可以把 B 的变化直接拿过来，放到 A 上，不产生新的 commit，需要人工进行 commit。此后在查看 log 时，只能看到一个 parent，即 A。</p>
<h1 id="HEAD-“-”-vs-“-”-vs-“-”"><a href="#HEAD-“-”-vs-“-”-vs-“-”" class="headerlink" title="HEAD “^” vs “~” vs “@{}”"></a>HEAD “^” vs “~” vs “@{}”</h1><p>在空白目录下运行以下 shell 脚本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 初始化</span></span><br><span class="line">git init</span><br><span class="line">git branch --move master main</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 构建分支</span></span><br><span class="line">echo 1 &gt;&gt; file</span><br><span class="line">git add file</span><br><span class="line">git commit -m &quot;main-commit-1&quot; -a</span><br><span class="line">echo 1 &gt;&gt; file</span><br><span class="line">git commit -m &quot;main-commit-2&quot; -a</span><br><span class="line">git checkout -b dev</span><br><span class="line">echo 1 &gt;&gt; dev</span><br><span class="line">git add dev</span><br><span class="line">git commit -m &quot;dev-commit-1&quot; -a</span><br><span class="line">git checkout -b prod</span><br><span class="line">echo 1 &gt;&gt; prod</span><br><span class="line">git add prod</span><br><span class="line">git commit -m &quot;prod-commit-1&quot; -a</span><br><span class="line">git switch main</span><br><span class="line">echo 1 &gt;&gt; file</span><br><span class="line">git commit -m &quot;main-commit-3&quot; -a</span><br><span class="line">git switch dev</span><br><span class="line">echo 1 &gt;&gt; dev</span><br><span class="line">git commit -m &quot;dev-commit-2&quot; -a</span><br><span class="line">git switch prod</span><br><span class="line">echo 1 &gt;&gt; prod</span><br><span class="line">git commit -m &quot;prod-commit-2&quot; -a</span><br><span class="line">git switch main</span><br><span class="line">git merge -m &quot;Merged dev&quot; dev</span><br><span class="line">echo 1 &gt;&gt; file</span><br><span class="line">git commit -m &quot;main-commit-4&quot; -a</span><br><span class="line">git merge -m &quot;Merged prod&quot; prod</span><br></pre></td></tr></table></figure>

<p>备注：图片中用的是 master 分支，没有改名为 main，不影响。</p>
<img src= "https://z3.ax1x.com/2021/08/18/fIcAZ6.gif" data-lazy-src="https://s1.ax1x.com/2022/09/26/xVt1bt.jpg" style="zoom: 60%;">

<p>上结论：</p>
<ul>
<li><p>HEAD^ HEAD^^… HEAD~ HEAD~~… HEAD<del>1 HEAD</del>2 <code>HEAD~&lt;n&gt;</code>… 都是在当前分支上找父结点，比如此时在 main 分支上 ，就只沿着 main 这条分支的父节点往前找。或者按 Git book 的说法来理解，<strong>每个 ^ 或 ~ 表示寻找其第一个父结点</strong>，多个叠加即寻找”第一个父结点的第一个父结点”。</p>
<blockquote>
<p>You can also specify a number after the <code>^</code> to identify <em>which</em> parent you want;</p>
<p>This syntax is useful only for merge commits, which have more than one parent — the <em>first</em> parent of a merge commit is from the branch you were on when you merged (frequently <code>master</code>), while the <em>second</em> parent of a merge commit is from the branch that was merged (say, <code>topic</code>):</p>
<p><code>HEAD~2</code> means “<strong>the first parent</strong> of <strong>the first parent</strong>,” or “the grandparent” — it traverses the first parents the number of times you specify.</p>
</blockquote>
</li>
<li><p><code>HEAD^&lt;n&gt;</code> 针对有 merge 的情况，HEAD^1 表示第一个父结点，HEAD^2 表示第二个父结点。如果当前 HEAD 不是 merge 得到的结点，那么它只有 HEAD^1，试图找 HEAD^2 会报错：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fatal: ambiguous argument &#x27;19588e4^2&#x27;: unknown revision or path not in the working tree.</span><br></pre></td></tr></table></figure></li>
<li><p><code>HEAD@&#123;&lt;n&gt;&#125;</code> 针对 reflog，与操作的次序有关。以下是特殊用法：</p>
<p><code>git log --no-walk HEAD^@</code> 可以列出当前结点的父结点，–no-walk 表示不显示祖先结点。比如 HEAD 在 merge-prod，该指令可以查看 merge 的两个父结点。如果不加 –no-walk，可以看到所有祖先结点。</p>
<p><code>git show HEAD^@</code> 可以查看父结点的详细信息，不需要 –no-walk 也不显示祖先。</p>
</li>
</ul>
<img src= "https://z3.ax1x.com/2021/08/18/fIcAZ6.gif" data-lazy-src="https://s1.ax1x.com/2022/09/26/xVt8VP.jpg" style="zoom: 50%;">

<ul>
<li>^ 和 ~ 也可以打组合拳，明确了 ^ 和 ~ 的语义后不难理解，^ 是纵向的第几个 parent，~ 是横向的第几个 parent，HEAD^^^ 这种属于特殊情况，可以这样看待：由于 HEAD^1 和 HEAD^ 等价，可以做拆分：((HEAD^)^)^，而 HEAD^ 和 HEAD~ 等价，所以多个 ^ 也和 ~ 等价。</li>
</ul>
<img src= "https://z3.ax1x.com/2021/08/18/fIcAZ6.gif" data-lazy-src="https://s1.ax1x.com/2022/09/26/xVN4Sg.jpg" style="zoom:42%;">

<h1 id="tools"><a href="#tools" class="headerlink" title="tools"></a>tools</h1><p><code>git show &lt;commit&gt;</code> 具体查看某一次提交。</p>
<p><code>git rev-parse &lt;branch&gt;</code> 查看分支指向结点的 Hash。</p>
<h2 id="double-dot"><a href="#double-dot" class="headerlink" title="double dot"></a>double dot</h2><blockquote>
<p>You can ask Git to show you a log of just those commits with <code>master..experiment</code> — **that means “all commits reachable from <code>experiment</code> that aren’t reachable from <code>master</code>.**”</p>
</blockquote>
<p><code>git log origin/master..HEAD</code> 可以查看 HEAD 拥有而 origin/master 没有的提交，从而确认本次 push 有哪些 commit。HEAD 可以省略。</p>
<blockquote>
<p>You can also leave off one side of the syntax to have Git assume <code>HEAD</code>. For example, you can get the same results as in the previous example by typing <code>git log origin/master..</code> — Git substitutes <code>HEAD</code> if one side is missing.</p>
</blockquote>
<h2 id="multiple-points"><a href="#multiple-points" class="headerlink" title="multiple points"></a>multiple points</h2><p>查看 B 有 A 没有的提交，有如下方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git log refA..refB</span><br><span class="line">$ git log ^refA refB</span><br><span class="line">$ git log refB --not refA</span><br></pre></td></tr></table></figure>

<p>第二、三行的语法可以对比更多分支，查找对应的提交：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git log refA refB ^refC</span><br><span class="line">$ git log refA refB --not refC</span><br></pre></td></tr></table></figure>

<h2 id="triple-dot"><a href="#triple-dot" class="headerlink" title="triple dot"></a>triple dot</h2><p>… 可以查看两个分支的“异或”，即只能被某一分之访问的提交。</p>
<p>可以搭配 –left-right 选项使用，<code>git log --left-right A...B</code>： &lt; 表示只能被 A 访问，&gt; 表示只能被 B 访问。</p>
<h2 id="patch-mode"><a href="#patch-mode" class="headerlink" title="patch mode"></a>patch mode</h2><p><code>add -p </code> 可以把一个文件分成多个 chunk，然后可将部分 chunk 添加到暂存区，如果 chunk 分得不够细，应用 s。</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Stage this hunk [y,n,a,d,/,j,J,g,e,?]? ?</span><br><span class="line">y - stage this hunk</span><br><span class="line">n - do not stage this hunk</span><br><span class="line">a - stage this and all the remaining hunks in the file</span><br><span class="line">d - do not stage this hunk nor any of the remaining hunks in the file</span><br><span class="line">g - select a hunk to go to</span><br><span class="line">/ - search for a hunk matching the given regex</span><br><span class="line">j - leave this hunk undecided, see next undecided hunk</span><br><span class="line">J - leave this hunk undecided, see next hunk</span><br><span class="line">k - leave this hunk undecided, see previous undecided hunk</span><br><span class="line">K - leave this hunk undecided, see previous hunk</span><br><span class="line">s - split the current hunk into smaller hunks</span><br><span class="line">e - manually edit the current hunk</span><br><span class="line">? - print help</span><br></pre></td></tr></table></figure>

<p>同样可以应用 patch mode 的还有 reset / checkout / stash，参考 7.2 节。</p>
<h2 id="stash"><a href="#stash" class="headerlink" title="stash"></a>stash</h2><p><code>git stash list</code> 查看 stash 列表。</p>
<p><code>git stash apply stash@&#123;&lt;n&gt;&#125;</code> 应用 stash，如果不指定，应用最新的 stash，应用后不会删除 stash。</p>
<p>添加 –index 选项，可以恢复 stash 之前的暂存区。</p>
<p><code>git stash drop stash@&#123;&lt;n&gt;&#125;</code> 删除 stash。</p>
<p><code>git stash clear</code> 清除所有 stash。</p>
<p><code>git stash pop stash@&#123;&lt;n&gt;&#125;</code>  是 apply 和 drop 的结合，需要注意的是，pop 也可以接 stash 名称，不只是可以 pop 最新的 stash。</p>
<p>如果要连续应用两次 stash，并且存在冲突，需要先把第一次的 stash 添加到暂存区，再执行一次 pop，此时才能解决冲突。</p>
<p>否则报错：error: Your local changes to the following files would be overwritten by merge.</p>
<p><code>git stash --keep-index</code> 仅把工作区的修改添加到 stash，不影响暂存区。</p>
<p>–include-untracked 或 -u 会把 untracked files 也加入 stash，但不会加入明确 ignored 的 file，如果要把它们也包含进来，用 -a 或 –all。</p>
<p>如果 stash 后在该分支上继续工作，应用 stash 的时候可能会遇到很多冲突，最佳实践是切到一个新的分支上应用 stash，可以简写为：<code>git stash branch &lt;branchname&gt; [&lt;stash&gt;]</code>。</p>
<h2 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h2><p><code>git grep &lt;content / regExp / wildcard&gt;</code>  查找。</p>
<p>选项需要加在 grep 后面，-c 显示数量，-n 显示行号，–and 指定多个条件。</p>
<h2 id="rebase-i"><a href="#rebase-i" class="headerlink" title="rebase -i"></a>rebase -i</h2><p><code>git rebase -i &lt;commit&gt;</code> 可以修改 commit 之前所有提交的记录。 </p>
<h3 id="edit"><a href="#edit" class="headerlink" title="edit"></a>edit</h3><p>将动词修改为 e 或 edit，保存并退出。</p>
<p>接下来，在需要 edit 的地方会停止，此时执行 git commit –amend 来修改，修改完后 git rebase –continue 继续。</p>
<h3 id="reorder-remove"><a href="#reorder-remove" class="headerlink" title="reorder / remove"></a>reorder / remove</h3><p>remove 就是把对应 pick 行删除，reorder 就是改变 pick 行顺序。</p>
<p>但我发现一个问题，先看看 shell：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mkdir try-git</span><br><span class="line">cd try-git</span><br><span class="line">git init</span><br><span class="line">git branch --move master main</span><br><span class="line"></span><br><span class="line">echo 1 &gt;&gt; file</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;commit-1&quot;</span><br><span class="line">echo 2 &gt;&gt; file</span><br><span class="line">git commit -m &quot;commit-2&quot; -a</span><br><span class="line">echo 3 &gt;&gt; file</span><br><span class="line">git commit -m &quot;commit-3&quot; -a</span><br><span class="line">echo 4 &gt;&gt; file</span><br><span class="line">git commit -m &quot;commit-4&quot; -a</span><br><span class="line">echo 5 &gt;&gt; file</span><br><span class="line">git commit -m &quot;commit-5&quot; -a</span><br><span class="line">echo 6 &gt;&gt; file</span><br><span class="line">git commit -m &quot;commit-6&quot; -a</span><br></pre></td></tr></table></figure>

<p>使用 rebase -i 删除 commit-4，需要解决冲突，此时发现，即使 commit-4 删除了，所做的修改仍然保留着，并且<strong>在合 commit-5 的时候，把 commit-4 的修改也包含进来了</strong>，如果要丢弃此修改，需要细心甄别。</p>
<p>使用 drop 和直接删除某一行的效果类似。</p>
<h3 id="squash"><a href="#squash" class="headerlink" title="squash"></a>squash</h3><p>如果此时有三条 pick 记录，A B C，想要把 B C 合到 A，则保持 pick A 不变，修改 B、C 为 squash。</p>
<p>之后编辑新的 commit message，保存即可。</p>
<h3 id="split"><a href="#split" class="headerlink" title="split"></a>split</h3><p>把想要拆分的 commit，改成 edit。</p>
<p>在这条 commit 处停下时，使用 <code>git reset HEAD^</code> 使修改进入工作区，然后 split 成多次提交，完成之后 rebase –continue 即可。</p>
<h2 id="reset"><a href="#reset" class="headerlink" title="reset"></a>reset</h2><p>git reset 如果后接 commit，工作流程：</p>
<ol>
<li><strong>当前分支随 HEAD 一起</strong>指向新的 commit。&lt;= <code>--soft </code> 停在这里</li>
<li>将版本库的内容复制到暂存区（index）。&lt;= <code>--mixed</code> 停在这里，默认选项</li>
<li>将暂存区的内容复制到工作区。&lt;= <code>--hard</code> </li>
</ol>
<p>git status 的原理是对比 HEAD、暂存区、工作区。</p>
<p>因此，使用 –soft 时，由于 HEAD 指向曾经的 commit，并且暂存区不变，因此暂存区和 HEAD 存在差异，新的暂存还未提交，所以 status 显示<strong>绿色</strong>。</p>
<p>使用 –mixed 时，由于 HEAD 的内容复制到了暂存区，现在暂存区和 HEAD 相同，但是工作区没有修改，所以工作区和暂存区有差异，status 显示<strong>红色</strong>。</p>
<p>使用 –hard 时，status 显示没有新的改变。</p>
<p>如果先使用 –mixed 回退，再使用 –soft 恢复到之前的 commit，那么会出现版本库和工作区一致，暂存区落后的情况，status 又红又绿。</p>
<p>git reset <strong>如果后接 path，那么不会发生上方第一步</strong>。</p>
<p>git reset file 会执行第二步，相当于回退了暂存区，因此此时 reset 的功能相当于 restore。</p>
<p><code>git reset &lt;commit&gt; &lt;file&gt;</code> 同样不会发生第一步，它会用该 commit 中的 file 去覆盖此时暂存区的 file，不影响工作区。此时只需要 提交即可。</p>
<p>reset 也可以用于合并多次 commit，只需要先 reset –soft 回退到某一版本，由于此时暂存区不变，只需要提交一次，即可把后面多次提交的内容合并为本次提交。当然不加 –soft 也可以，需要多加一次暂存区。</p>
<h2 id="rerere"><a href="#rerere" class="headerlink" title="rerere"></a>rerere</h2><p>revere 是 reuse / recorded / resolution 的缩写，意为”复用冲突解决的记录”。</p>
<p>rerere 可以复用之前的 merge conflict resolution。</p>
<p><code>git config --global rerere.enabled true</code> 打开 rerere。</p>
<p>此后，第一次 merge 时，会被 rerere cache 记录，merge 后的信息多了一行：</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Recorded preimage for &#x27;&lt;filename&gt;&#x27; </span><br></pre></td></tr></table></figure>

<p><code>git rerere diff</code> 可以查看当前 resolution 的状态。</p>
<p>然后解决冲突并提交，使用 <code>reset --hard HEAD~</code> 回退，再次 merge，发现之前的 resolution 会自动生效。</p>
<p>如果需要恢复冲突状态，使用 <code>git checkout --conflict=merge &lt;filename&gt;</code>。</p>
<p>在冲突状态下重新应用 rerere，使用 <code>git rerere</code>。</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/git/">git</a></div><div class="post_share"><div class="social-share" data-image="https://z3.ax1x.com/2021/08/17/fIut8s.png" data-sites="wechat,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/10/13/jsb/"><img class="prev-cover" src= "https://z3.ax1x.com/2021/08/18/fIcAZ6.gif" data-lazy-src="https://z3.ax1x.com/2021/08/17/fIut8s.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">JSBridge</div></div></a></div><div class="next-post pull-right"><a href="/2022/10/13/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"><img class="next-cover" src= "https://z3.ax1x.com/2021/08/18/fIcAZ6.gif" data-lazy-src="https://z3.ax1x.com/2021/08/17/fIut8s.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">正则表达式</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "https://z3.ax1x.com/2021/08/18/fIcAZ6.gif" data-lazy-src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Danmoits</div><div class="author-info__description">HUST-CS-20</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/DanmoSAMA"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Basic"><span class="toc-number">1.</span> <span class="toc-text">Basic</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#status"><span class="toc-number">1.1.</span> <span class="toc-text">status</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#diff"><span class="toc-number">1.2.</span> <span class="toc-text">diff</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#commit"><span class="toc-number">1.3.</span> <span class="toc-text">commit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rm"><span class="toc-number">1.4.</span> <span class="toc-text">rm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mv"><span class="toc-number">1.5.</span> <span class="toc-text">mv</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#log"><span class="toc-number">1.6.</span> <span class="toc-text">log</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#amend"><span class="toc-number">1.7.</span> <span class="toc-text">amend</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#remote"><span class="toc-number">2.</span> <span class="toc-text">remote</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#tag"><span class="toc-number">3.</span> <span class="toc-text">tag</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#branch"><span class="toc-number">4.</span> <span class="toc-text">branch</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#basic"><span class="toc-number">4.1.</span> <span class="toc-text">basic</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#remote-1"><span class="toc-number">4.2.</span> <span class="toc-text">remote</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rebase"><span class="toc-number">4.3.</span> <span class="toc-text">rebase</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#perils-of-rebase"><span class="toc-number">4.3.1.</span> <span class="toc-text">perils of rebase</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#distributed-git"><span class="toc-number">5.</span> <span class="toc-text">distributed git</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HEAD-%E2%80%9C-%E2%80%9D-vs-%E2%80%9C-%E2%80%9D-vs-%E2%80%9C-%E2%80%9D"><span class="toc-number">6.</span> <span class="toc-text">HEAD “^” vs “~” vs “@{}”</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#tools"><span class="toc-number">7.</span> <span class="toc-text">tools</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#double-dot"><span class="toc-number">7.1.</span> <span class="toc-text">double dot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#multiple-points"><span class="toc-number">7.2.</span> <span class="toc-text">multiple points</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#triple-dot"><span class="toc-number">7.3.</span> <span class="toc-text">triple dot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#patch-mode"><span class="toc-number">7.4.</span> <span class="toc-text">patch mode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#stash"><span class="toc-number">7.5.</span> <span class="toc-text">stash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#grep"><span class="toc-number">7.6.</span> <span class="toc-text">grep</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rebase-i"><span class="toc-number">7.7.</span> <span class="toc-text">rebase -i</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#edit"><span class="toc-number">7.7.1.</span> <span class="toc-text">edit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reorder-remove"><span class="toc-number">7.7.2.</span> <span class="toc-text">reorder &#x2F; remove</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#squash"><span class="toc-number">7.7.3.</span> <span class="toc-text">squash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#split"><span class="toc-number">7.7.4.</span> <span class="toc-text">split</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reset"><span class="toc-number">7.8.</span> <span class="toc-text">reset</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rerere"><span class="toc-number">7.9.</span> <span class="toc-text">rerere</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('/img/index.png')"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Danmoits</div><div class="footer_custom_text"><span>天気はいから，散歩しましよ。</span><br><a href="http://beian.miit.gov.cn/"  style="color:#f72b07" target="_blank">鄂ICP备2021014938号</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '38f3004c23ea76e7b591',
      clientSecret: '7f26b7a58a9d40bacc884c008e5329b6bf1365e8',
      repo: 'DanmoSAMA.github.io',
      owner: 'DanmoSAMA',
      admin: ['DanmoSAMA'],
      id: 'bc676f66ed8e84dd402ac9d43a609e4f',
      updateCountCallback: commentCount
    },))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><link rel="stylesheet" href="https://butterfly.lete114.top/css/Lete.css"><script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js"></script><script src="/js/custom.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='all'|| 'all' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><a class="magnet_link_more"  href="https://danmosama.github.io/categories" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>';
    console.log('已挂载magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(50% - 5px);background: #f2f2f2;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: #b30070}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>function history_calendar_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>那年今日</span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>';
                console.log('已挂载history_calendar')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='/'|| '/' ==='all')){

            history_calendar_injector_config()
        } </script><script data-pjax  src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script><script data-pjax>function electric_clock_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img id="card-clock-loading" src= "https://z3.ax1x.com/2021/08/18/fIcAZ6.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading" class="entered loading"></div></div></div></div></div>';
                console.log('已挂载electric_clock')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='/'|| '/' ==='all')){

            electric_clock_injector_config()
        } </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax  src="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.js"></script><!-- hexo injector body_end end --></body></html>